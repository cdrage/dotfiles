#!/bin/bash

dcleanup(){
  docker rm $(docker ps --filter status=exited -q 2>/dev/null) 2>/dev/null
  docker rmi $(docker images --filter dangling=true -q 2>/dev/null) 2>/dev/null
}

del_stopped(){
  local name=$1
  local state=$(docker inspect --format "{{.State.Running}}" $name 2>/dev/null)

  if [[ "$state" == "false" ]]; then
    docker rm $name
  fi
}

relies_on(){
  local containers=$@

  for container in $containers; do
    local state=$(docker inspect --format "{{.State.Running}}" $container 2>/dev/null)

    if [[ "$state" == "false" ]] || [[ "$state" == "" ]]; then
      echo "$container is not running, starting it for you."
      $container
    fi
  done
}

# Functions

mutt(){
  docker run -it --rm \
    -e MUTT \
    -e MUTT_NAME \
    -e MUTT_PASS \
    -e MUTT_FROM \
    -e MUTT_SMTP \
    -e MUTT_IMAP \
    -v /etc/localtime:/etc/localtime:ro \
    charliedrage/mutt
}

weechat(){
  CONTAINER=weechat
  RUNNING=$(docker inspect --format="{{ .State.Running }}" $CONTAINER 2> /dev/null) 

  if [ $RUNNING ] ; then
    docker attach weechat
  else
    docker run -it -d \
      -v ~/.weechat:/root/.weechat \
      -v /etc/localtime:/etc/localtime:ro \
      --name weechat \
      charliedrage/weechat
    docker attach weechat
  fi

}

